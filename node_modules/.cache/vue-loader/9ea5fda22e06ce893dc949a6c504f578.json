{"remainingRequest":"D:\\Kampus\\SEMESTER 5\\PBKK\\patreon-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Kampus\\SEMESTER 5\\PBKK\\patreon-vue\\src\\components\\SettingsModal.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"D:\\Kampus\\SEMESTER 5\\PBKK\\patreon-vue\\src\\components\\SettingsModal.vue","mtime":1730447401960},{"path":"D:\\Kampus\\SEMESTER 5\\PBKK\\patreon-vue\\node_modules\\css-loader\\dist\\cjs.js","mtime":1730447646010},{"path":"D:\\Kampus\\SEMESTER 5\\PBKK\\patreon-vue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1730447648140},{"path":"D:\\Kampus\\SEMESTER 5\\PBKK\\patreon-vue\\node_modules\\postcss-loader\\src\\index.js","mtime":1730447646049},{"path":"D:\\Kampus\\SEMESTER 5\\PBKK\\patreon-vue\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1730447644413},{"path":"D:\\Kampus\\SEMESTER 5\\PBKK\\patreon-vue\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1730447647589},{"path":"D:\\Kampus\\SEMESTER 5\\PBKK\\patreon-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1730447643917},{"path":"D:\\Kampus\\SEMESTER 5\\PBKK\\patreon-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":1730447647010}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCiNtb2RhbC1oZWFkZXIgew0KICBib3JkZXItYm90dG9tOiAxcHggc29saWQgcmdiKDIzOCwgMjMyLCAyMzIpOw0KfQ0KDQojc2V0dGluZ3MtaW1hZ2UtcGxhY2Vob2xkZXIgew0KICBwYWRkaW5nLXRvcDogN2VtOw0KICBwYWRkaW5nLWJvdHRvbTogN2VtOw0KICBib3JkZXI6IDJweCBkYXNoZWQgcmdiKDIwOSwgMjA5LCAyMDkpOw0KICBib3JkZXItcmFkaXVzOiA1MCU7DQp9DQoNCkBtZWRpYSAobWF4LXdpZHRoOiA3MDBweCkgew0KICAudnVlLWltYWdlLWNyb3AtdXBsb2FkIHsNCiAgICAudmljcC13cmFwIHsNCiAgICAgIHdpZHRoOiA5NSU7DQogICAgICBoZWlnaHQ6IDU1MHB4Ow0KICAgICAgLnZpY3Atc3RlcDIgLnZpY3AtY3JvcCB7DQogICAgICAgIC52aWNwLWNyb3AtbGVmdCB7DQogICAgICAgICAgZmxvYXQ6IG5vbmU7DQoNCiAgICAgICAgICAudmljcC1yYW5nZSB7DQogICAgICAgICAgICBtYXJnaW46IGF1dG87DQogICAgICAgICAgICBtYXJnaW4tdG9wOiAzMHB4Ow0KICAgICAgICAgIH0NCg0KICAgICAgICAgICYgKiB7DQogICAgICAgICAgICBtYXJnaW4tbGVmdDogYXV0bzsNCiAgICAgICAgICAgIG1hcmdpbi1yaWdodDogYXV0bzsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgLnZpY3AtY3JvcC1yaWdodCB7DQogICAgICAgICAgZmxvYXQ6IG5vbmU7DQogICAgICAgICAgbWFyZ2luLXRvcDogMzBweDsNCiAgICAgICAgICAudmljcC1wcmV2aWV3IC52aWNwLXByZXZpZXctaXRlbSB7DQogICAgICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7DQogICAgICAgICAgICBmbG9hdDogbm9uZTsNCiAgICAgICAgICB9DQogICAgICAgICAgJiAqIHsNCiAgICAgICAgICAgIC8vIG1hcmdpbi1sZWZ0OiBhdXRvOw0KICAgICAgICAgICAgLy8gbWFyZ2luLXJpZ2h0OiBhdXRvOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["SettingsModal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmVA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SettingsModal.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <v-dialog\r\n    v-model=\"dialog\"\r\n    persistent\r\n    transition=\"fab-transition\"\r\n    max-width=\"800\"\r\n    id=\"settings\"\r\n  >\r\n    <v-card tile>\r\n      <div class=\"d-flex justify-space-between mb-5\" id=\"modal-header\">\r\n        <v-card-title class=\"py-3\">Settings</v-card-title>\r\n\r\n        <v-btn icon text @click=\"closeModal\">\r\n          <v-icon>mdi-close</v-icon>\r\n        </v-btn>\r\n      </div>\r\n\r\n      <v-card-text>\r\n        <v-row>\r\n          <v-col\r\n            order=\"last\"\r\n            order-sm=\"last\"\r\n            order-md=\"first\"\r\n            order-lg=\"first\"\r\n            order-xl=\"first\"\r\n            cols=\"12\"\r\n            sm=\"12\"\r\n            md=\"8\"\r\n            lg=\"8\"\r\n            class=\"pt-0\"\r\n          >\r\n            <h3 class=\"mb-6 mt-0 pt-0\">Personal Information</h3>\r\n            <ValidationObserver\r\n              ref=\"personalInfoForm\"\r\n              v-slot=\"{ handleSubmit, reset }\"\r\n            >\r\n              <form\r\n                @submit.prevent=\"handleSubmit(submit)\"\r\n                @reset.prevent=\"reset\"\r\n              >\r\n                <ValidationProvider\r\n                  v-slot=\"{ errors }\"\r\n                  name=\"Channel Name\"\r\n                  rules=\"required|min:3\"\r\n                >\r\n                  <v-text-field\r\n                    v-model=\"formData.channelName\"\r\n                    :error-messages=\"errors\"\r\n                    label=\"Channel Name\"\r\n                    filled\r\n                    dense\r\n                  ></v-text-field>\r\n                </ValidationProvider>\r\n                <ValidationProvider\r\n                  v-slot=\"{ errors }\"\r\n                  name=\"email\"\r\n                  rules=\"required|email\"\r\n                >\r\n                  <v-text-field\r\n                    v-model=\"formData.email\"\r\n                    :error-messages=\"errors\"\r\n                    label=\"Email\"\r\n                    filled\r\n                    dense\r\n                  ></v-text-field>\r\n                </ValidationProvider>\r\n\r\n                <v-btn\r\n                  :loading=\"loading.personalInfo\"\r\n                  type=\"submit\"\r\n                  class=\"primary \"\r\n                  depressed\r\n                  >Submit</v-btn\r\n                >\r\n              </form>\r\n            </ValidationObserver>\r\n\r\n            <h3 class=\"mb-6 mt-6\">Change Password</h3>\r\n            <ValidationObserver\r\n              ref=\"passwordForm\"\r\n              v-slot=\"{ handleSubmit, reset }\"\r\n            >\r\n              <form\r\n                @submit.prevent=\"handleSubmit(submitPassword)\"\r\n                @reset.prevent=\"reset\"\r\n              >\r\n                <ValidationProvider\r\n                  v-slot=\"{ errors }\"\r\n                  name=\"Current password\"\r\n                  rules=\"required|min:5\"\r\n                >\r\n                  <v-text-field\r\n                    v-model=\"formData.currentPassword\"\r\n                    :append-icon=\"\r\n                      showCurrentPassword ? 'mdi-eye' : 'mdi-eye-off'\r\n                    \"\r\n                    :error-messages=\"errors\"\r\n                    :type=\"showCurrentPassword ? 'text' : 'password'\"\r\n                    name=\"Current password\"\r\n                    label=\"Current Password\"\r\n                    filled\r\n                    dense\r\n                    hint=\"At least 5 characters\"\r\n                    class=\"input-group--focused\"\r\n                    @click:append=\"showCurrentPassword = !showCurrentPassword\"\r\n                  ></v-text-field>\r\n                </ValidationProvider>\r\n                <ValidationProvider\r\n                  v-slot=\"{ errors }\"\r\n                  name=\"New password\"\r\n                  rules=\"required|min:5\"\r\n                >\r\n                  <v-text-field\r\n                    v-model=\"formData.newPassword\"\r\n                    :append-icon=\"showNewPassword ? 'mdi-eye' : 'mdi-eye-off'\"\r\n                    :error-messages=\"errors\"\r\n                    :type=\"showNewPassword ? 'text' : 'password'\"\r\n                    name=\"New password\"\r\n                    label=\"New Password\"\r\n                    filled\r\n                    dense\r\n                    hint=\"At least 5 characters\"\r\n                    class=\"input-group--focused\"\r\n                    @click:append=\"showNewPassword = !showNewPassword\"\r\n                  ></v-text-field>\r\n                </ValidationProvider>\r\n\r\n                <v-btn\r\n                  :loading=\"loading.password\"\r\n                  type=\"submit\"\r\n                  class=\"primary\"\r\n                  depressed\r\n                  >Submit</v-btn\r\n                >\r\n              </form>\r\n            </ValidationObserver>\r\n          </v-col>\r\n          <v-col\r\n            order-sm=\"1\"\r\n            cols=\"12\"\r\n            sm=\"12\"\r\n            md=\"4\"\r\n            lg=\"4\"\r\n            class=\"text-center\"\r\n          >\r\n            <v-btn text @click=\"toggleShow\">Upload Avatar</v-btn>\r\n            <my-upload\r\n              field=\"avatar\"\r\n              method=\"PUT\"\r\n              :headers=\"headers\"\r\n              @crop-success=\"cropSuccess\"\r\n              @crop-upload-success=\"cropUploadSuccess\"\r\n              @crop-upload-fail=\"cropUploadFail\"\r\n              v-model=\"show\"\r\n              :url=\"url\"\r\n              :width=\"200\"\r\n              :height=\"200\"\r\n              :noRotate=\"false\"\r\n              img-format=\"jpg\"\r\n              langType=\"en\"\r\n            ></my-upload>\r\n            <v-responsive\r\n              width=\"230\"\r\n              class=\"mx-auto\"\r\n              style=\"border-radius: 50%;\"\r\n            >\r\n              <div\r\n                v-if=\"$store.getters.currentUser.photoUrl == 'no-photo.jpg'\"\r\n                class=\"px-12\"\r\n                id=\"settings-image-placeholder\"\r\n              >\r\n                <v-icon>mdi-image-plus</v-icon>\r\n              </div>\r\n              <v-img v-else height=\"220\" :src=\"imgDataUrl\"></v-img>\r\n            </v-responsive>\r\n          </v-col>\r\n        </v-row>\r\n      </v-card-text>\r\n    </v-card>\r\n  </v-dialog>\r\n</template>\r\n\r\n<script>\r\nimport AuthenticationService from '@/services/AuthenticationService'\r\nimport myUpload from 'vue-image-crop-upload'\r\n\r\nexport default {\r\n  name: 'SettingsModal',\r\n  props: ['openDialog'],\r\n  data: function() {\r\n    return {\r\n      showCurrentPassword: false,\r\n      showNewPassword: false,\r\n      valid: false,\r\n      interval: {},\r\n      value: 0,\r\n      show: false,\r\n      rules: [\r\n        (value) =>\r\n          !value ||\r\n          value.size < 5000000 ||\r\n          'Video size should be less than 5 MB!'\r\n      ],\r\n      categories: ['People', 'Technology', 'Fashion'],\r\n      visibilty: ['Public', 'Private'],\r\n      formData: {\r\n        channelName: this.$store.getters.currentUser.channelName,\r\n        email: this.$store.getters.currentUser.email,\r\n        currentPassword: '',\r\n        newPassword: ''\r\n      },\r\n      loading: {\r\n        personalInfo: false,\r\n        password: false\r\n      },\r\n      imgDataUrl: `${process.env.VUE_APP_URL}/uploads/avatars/${this.$store.getters.currentUser.photoUrl}`,\r\n      url: `${process.env.VUE_APP_URL}/api/v1/auth/avatar`,\r\n      headers: { Authorization: `Bearer ${this.$store.getters.getToken}` }\r\n    }\r\n  },\r\n  computed: {\r\n    dialog() {\r\n      return this.openDialog\r\n    }\r\n  },\r\n  methods: {\r\n    async submit() {\r\n      if (this.loading.personalInfo) return\r\n      this.loading.personalInfo = true\r\n\r\n      const user = await AuthenticationService.updateUserDetails({\r\n        channelName: this.formData.channelName,\r\n        email: this.formData.email\r\n      })\r\n        .catch((err) => {\r\n          this.loading.personalInfo = false\r\n          const errors = err.response.data.error\r\n\r\n          this.$refs.personalInfoForm.setErrors({\r\n            'email': errors.find((error) => {\r\n              return error.field === 'email'\r\n            })\r\n              ? ['This email is already taken']\r\n              : null,\r\n            'Channel Name': errors.find((error) => {\r\n              return error.field === 'channelName'\r\n            })\r\n              ? ['This channel name is already taken']\r\n              : null\r\n          })\r\n        })\r\n        .finally(() => (this.loading.personalInfo = false))\r\n\r\n      if (!user) return\r\n      if (\r\n        this.formData.channelName !==\r\n          this.$store.getters.currentUser.channelName ||\r\n        this.formData.email !== this.$store.getters.currentUser.email\r\n      ) {\r\n        this.$store.dispatch('signOut')\r\n        this.$router.push('/signin')\r\n      }\r\n\r\n      this.closeModal()\r\n    },\r\n    async submitPassword() {\r\n      if (this.loading.password) return\r\n\r\n      this.loading.password = true\r\n\r\n      const user = await AuthenticationService.updatePassword({\r\n        currentPassword: this.formData.currentPassword,\r\n        newPassword: this.formData.newPassword\r\n      })\r\n        .catch((err) => {\r\n          this.loading.password = false\r\n          const errors = err.response.data.error\r\n\r\n          this.$refs.passwordForm.setErrors({\r\n            'Current password': errors.find((error) => {\r\n              return error.field === 'currentPassword'\r\n            })\r\n              ? ['Current password is incorrect']\r\n              : null,\r\n            'New password': errors.find((error) => {\r\n              return error.field === 'newPassword'\r\n            })\r\n              ? errors.find((error) => {\r\n                  return error.field === 'newPassword'\r\n                }).message\r\n              : null\r\n          })\r\n        })\r\n        .finally(() => (this.loading.password = false))\r\n      if (!user) return\r\n\r\n      this.formData.currentPassword = ''\r\n      this.formData.newPassword = ''\r\n      this.closeModal()\r\n\r\n      this.$store.dispatch('signOut')\r\n      this.$router.push('/signin')\r\n    },\r\n    closeModal() {\r\n      this.$emit('closeDialog')\r\n    },\r\n\r\n    toggleShow() {\r\n      this.show = !this.show\r\n    },\r\n    cropSuccess(imgDataUrl, field) {\r\n      // console.log('-------- crop success --------')\r\n      console.log(field)\r\n      // console.log(imgDataUrl)\r\n      this.imgDataUrl = imgDataUrl\r\n      // console.log(this.imgDataUrl)\r\n      // console.log(field)\r\n    },\r\n    cropUploadSuccess(jsonData, field) {\r\n      // console.log('-------- upload success --------')\r\n      const user = this.$store.getters.currentUser\r\n      user.photoUrl = jsonData.data\r\n      this.$store.dispatch('signin', user)\r\n      console.log('field: ' + field)\r\n    },\r\n\r\n    cropUploadFail(status, field) {\r\n      console.log('-------- upload fail --------')\r\n      console.log(status)\r\n      console.log('field: ' + field)\r\n    }\r\n  },\r\n  components: {\r\n    myUpload\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n#modal-header {\r\n  border-bottom: 1px solid rgb(238, 232, 232);\r\n}\r\n\r\n#settings-image-placeholder {\r\n  padding-top: 7em;\r\n  padding-bottom: 7em;\r\n  border: 2px dashed rgb(209, 209, 209);\r\n  border-radius: 50%;\r\n}\r\n\r\n@media (max-width: 700px) {\r\n  .vue-image-crop-upload {\r\n    .vicp-wrap {\r\n      width: 95%;\r\n      height: 550px;\r\n      .vicp-step2 .vicp-crop {\r\n        .vicp-crop-left {\r\n          float: none;\r\n\r\n          .vicp-range {\r\n            margin: auto;\r\n            margin-top: 30px;\r\n          }\r\n\r\n          & * {\r\n            margin-left: auto;\r\n            margin-right: auto;\r\n          }\r\n        }\r\n        .vicp-crop-right {\r\n          float: none;\r\n          margin-top: 30px;\r\n          .vicp-preview .vicp-preview-item {\r\n            display: inline-block;\r\n            float: none;\r\n          }\r\n          & * {\r\n            // margin-left: auto;\r\n            // margin-right: auto;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}